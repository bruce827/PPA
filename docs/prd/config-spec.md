# å‚æ•°é…ç½®åŠŸèƒ½è¯¦ç»†è§„æ ¼

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-21

---

## 1. åŠŸèƒ½æ¦‚è¿°

å‚æ•°é…ç½®æ¨¡å—æä¾›ç³»ç»ŸåŸºç¡€æ•°æ®çš„ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬é¡¹ç›®è§’è‰²ã€é£é™©è¯„ä¼°é¡¹å’Œå·®æ—…æˆæœ¬çš„é…ç½®ã€‚è¿™äº›é…ç½®æ•°æ®æ˜¯é¡¹ç›®è¯„ä¼°çš„åŸºç¡€ï¼Œç›´æ¥å½±å“æˆæœ¬è®¡ç®—å’Œé£é™©è¯„åˆ†çš„å‡†ç¡®æ€§ã€‚

## 2. åŠŸèƒ½å…¥å£

### 2.1 è·¯ç”±

- **è·¯å¾„**: `/config`
- **å­è·¯ç”±**:
  - `/config/roles` - è§’è‰²ç®¡ç†
  - `/config/risk-items` - é£é™©é¡¹ç®¡ç†
  - `/config/travel-costs` - å·®æ—…æˆæœ¬ç®¡ç†

### 2.2 å¯¼èˆªå…¥å£

- å·¦ä¾§èœå•ï¼šå‚æ•°é…ç½®
  - è§’è‰²ç®¡ç†
  - é£é™©é¡¹ç®¡ç†
  - å·®æ—…æˆæœ¬ç®¡ç†

---

## 3. æ¨¡å—1: è§’è‰²ç®¡ç†

### 3.1 åŠŸèƒ½æ¦‚è¿°

ç®¡ç†é¡¹ç›®ä¸­æ¶‰åŠçš„å„ç±»è§’è‰²åŠå…¶å•ä»·é…ç½®ï¼Œç”¨äºå·¥ä½œé‡æˆæœ¬è®¡ç®—ã€‚

### 3.2 é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ å‚æ•°é…ç½® > è§’è‰²ç®¡ç†                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  [+ æ–°å»ºè§’è‰²]                  [ğŸ” æœç´¢...]     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è§’è‰²åç§°  â”‚ å•ä»·(å…ƒ/æœˆ) â”‚ çŠ¶æ€ â”‚ æ“ä½œ    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ é¡¹ç›®ç»ç†  â”‚ 32,000     â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â”‚ æŠ€æœ¯ç»ç†  â”‚ 36,000     â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â”‚ UIè®¾è®¡å¸ˆ  â”‚ 24,000     â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â”‚ ...                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 æ•°æ®ç»“æ„

```typescript
interface RoleConfig {
  id: number;
  role_name: string;        // è§’è‰²åç§°
  unit_price: number;       // å•ä»·ï¼ˆå…ƒ/æœˆï¼‰
  is_active: boolean;       // æ˜¯å¦å¯ç”¨
  created_at: string;
  updated_at?: string;
}
```

### 3.4 è¡¨æ ¼åˆ—é…ç½®

```typescript
const columns: ProColumns<RoleConfig>[] = [
  {
    title: 'è§’è‰²åç§°',
    dataIndex: 'role_name',
    key: 'role_name',
    width: '30%',
    sorter: true,
    formItemProps: {
      rules: [
        { required: true, message: 'è¯·è¾“å…¥è§’è‰²åç§°' },
        { max: 50, message: 'è§’è‰²åç§°ä¸è¶…è¿‡50å­—ç¬¦' },
      ],
    },
  },
  {
    title: 'å•ä»·ï¼ˆå…ƒ/æœˆï¼‰',
    dataIndex: 'unit_price',
    key: 'unit_price',
    width: '25%',
    sorter: true,
    align: 'right',
    valueType: 'digit',
    fieldProps: {
      precision: 0,
      min: 0,
      max: 1000000,
      formatter: (value) => `${value}`.replace(/\B(?=(\d{3})+(?!\d))/g, ','),
      parser: (value) => value.replace(/\$\s?|(,*)/g, ''),
    },
    formItemProps: {
      rules: [
        { required: true, message: 'è¯·è¾“å…¥å•ä»·' },
      ],
    },
    render: (value) => `Â¥ ${value.toLocaleString()}`,
  },
  {
    title: 'çŠ¶æ€',
    dataIndex: 'is_active',
    key: 'is_active',
    width: '15%',
    valueType: 'select',
    valueEnum: {
      true: { text: 'å¯ç”¨', status: 'Success' },
      false: { text: 'ç¦ç”¨', status: 'Default' },
    },
    render: (_, record) => (
      <Badge
        status={record.is_active ? 'success' : 'default'}
        text={record.is_active ? 'å¯ç”¨' : 'ç¦ç”¨'}
      />
    ),
  },
  {
    title: 'æ“ä½œ',
    key: 'actions',
    width: '30%',
    valueType: 'option',
    render: (_, record, __, action) => [
      <a key="edit" onClick={() => action?.startEditable(record.id)}>
        ç¼–è¾‘
      </a>,
      <a
        key="toggle"
        onClick={() => toggleRoleStatus(record.id, !record.is_active)}
      >
        {record.is_active ? 'ç¦ç”¨' : 'å¯ç”¨'}
      </a>,
      <Popconfirm
        key="delete"
        title="ç¡®å®šåˆ é™¤æ­¤è§’è‰²å—ï¼Ÿ"
        description="åˆ é™¤åæ— æ³•æ¢å¤ï¼Œä¸”å¯èƒ½å½±å“å†å²é¡¹ç›®æ•°æ®ã€‚"
        onConfirm={() => deleteRole(record.id)}
      >
        <a style={{ color: 'red' }}>åˆ é™¤</a>
      </Popconfirm>,
    ],
  },
];
```

### 3.5 æ“ä½œåŠŸèƒ½

#### 3.5.1 æ–°å»ºè§’è‰²

**è§¦å‘**: ç‚¹å‡»"+ æ–°å»ºè§’è‰²"æŒ‰é’®

**è¡¨å•å­—æ®µ**:
- è§’è‰²åç§°ï¼ˆå¿…å¡«ï¼‰
- å•ä»·ï¼ˆå¿…å¡«ï¼Œå…ƒ/æœˆï¼‰
- çŠ¶æ€ï¼ˆé»˜è®¤å¯ç”¨ï¼‰

**éªŒè¯è§„åˆ™**:
- è§’è‰²åç§°ä¸èƒ½é‡å¤
- å•ä»·å¿…é¡» > 0
- å•ä»·ä¸Šé™: 100ä¸‡å…ƒ/æœˆ

**ä¿å­˜é€»è¾‘**:
```typescript
const handleAdd = async (values: RoleConfig) => {
  try {
    const response = await fetch('/api/config/roles', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(values),
    });
    
    if (response.ok) {
      message.success('è§’è‰²åˆ›å»ºæˆåŠŸ');
      actionRef.current?.reload();
    }
  } catch (error) {
    message.error('åˆ›å»ºå¤±è´¥ï¼Œè¯·é‡è¯•');
  }
};
```

#### 3.5.2 ç¼–è¾‘è§’è‰²

**è§¦å‘**: ç‚¹å‡»"ç¼–è¾‘"é“¾æ¥

**è¡Œä¸º**:
- è¡¨æ ¼è¡Œåˆ‡æ¢ä¸ºç¼–è¾‘æ¨¡å¼
- å…è®¸ä¿®æ”¹è§’è‰²åç§°å’Œå•ä»·
- ç‚¹å‡»"âœ“"ä¿å­˜ï¼Œç‚¹å‡»"Ã—"å–æ¶ˆ

**ä¿å­˜é€»è¾‘**:
```typescript
const handleEdit = async (id: number, values: Partial<RoleConfig>) => {
  try {
    const response = await fetch(`/api/config/roles/${id}`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(values),
    });
    
    if (response.ok) {
      message.success('è§’è‰²æ›´æ–°æˆåŠŸ');
      return true;
    }
  } catch (error) {
    message.error('æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•');
    return false;
  }
};
```

#### 3.5.3 å¯ç”¨/ç¦ç”¨è§’è‰²

**è§¦å‘**: ç‚¹å‡»"å¯ç”¨"æˆ–"ç¦ç”¨"é“¾æ¥

**è¡Œä¸º**:
- ç¦ç”¨åï¼Œè¯¥è§’è‰²åœ¨æ–°å»ºè¯„ä¼°æ—¶ä¸å¯é€‰
- ä¸å½±å“å·²æœ‰é¡¹ç›®ä¸­çš„å†å²æ•°æ®
- æ˜¾ç¤ºç¡®è®¤æç¤º

#### 3.5.4 åˆ é™¤è§’è‰²

**è§¦å‘**: ç‚¹å‡»"åˆ é™¤"é“¾æ¥

**è¡Œä¸º**:
- æ˜¾ç¤ºäºŒæ¬¡ç¡®è®¤å¯¹è¯æ¡†
- æç¤ºå¯èƒ½å½±å“å†å²é¡¹ç›®
- å»ºè®®ä½¿ç”¨"ç¦ç”¨"è€Œéåˆ é™¤

**é™åˆ¶**:
- å¦‚æœæœ‰é¡¹ç›®æ­£åœ¨ä½¿ç”¨è¯¥è§’è‰²ï¼Œä¸å…è®¸åˆ é™¤
- æç¤ºå…ˆç¦ç”¨è¯¥è§’è‰²

---

## 4. æ¨¡å—2: é£é™©é¡¹ç®¡ç†

### 4.1 åŠŸèƒ½æ¦‚è¿°

ç®¡ç†é£é™©è¯„ä¼°æ‰€éœ€çš„è¯„ä¼°é¡¹åŠå…¶é€‰é¡¹é…ç½®ï¼Œç”¨äºé¡¹ç›®é£é™©è¯„åˆ†ã€‚

### 4.2 é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ å‚æ•°é…ç½® > é£é™©é¡¹ç®¡ç†                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  [+ æ–°å»ºé£é™©é¡¹]                [ğŸ” æœç´¢...]     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ åˆ†ç±»  â”‚ è¯„ä¼°é¡¹     â”‚ é€‰é¡¹é…ç½® â”‚ çŠ¶æ€â”‚æ“ä½œâ”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ éœ€æ±‚  â”‚ éœ€æ±‚æ˜ç¡®åº¦ â”‚ 5ä¸ªé€‰é¡¹  â”‚å¯ç”¨â”‚[..]â”‚ â”‚
â”‚  â”‚ æŠ€æœ¯  â”‚ æŠ€æœ¯éš¾åº¦   â”‚ 5ä¸ªé€‰é¡¹  â”‚å¯ç”¨â”‚[..]â”‚ â”‚
â”‚  â”‚ ...                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 æ•°æ®ç»“æ„

```typescript
interface RiskItemConfig {
  id: number;
  category: string;         // é£é™©ç±»åˆ«
  item_name: string;        // è¯„ä¼°é¡¹åç§°
  options_json: string;     // é€‰é¡¹é…ç½®ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
  is_active: boolean;       // æ˜¯å¦å¯ç”¨
  created_at: string;
  updated_at?: string;
}

// é€‰é¡¹é…ç½®è§£æåçš„ç»“æ„
interface RiskOption {
  label: string;            // é€‰é¡¹æè¿°ï¼Œå¦‚"éœ€æ±‚éå¸¸æ˜ç¡®"
  score: number;            // å¯¹åº”åˆ†å€¼ï¼Œå¦‚ 2
}

// options_json ç¤ºä¾‹
const optionsExample = [
  { label: "éœ€æ±‚éå¸¸æ˜ç¡®", score: 2 },
  { label: "éœ€æ±‚åŸºæœ¬æ˜ç¡®", score: 4 },
  { label: "éœ€æ±‚éƒ¨åˆ†æ˜ç¡®", score: 6 },
  { label: "éœ€æ±‚ä¸å¤ªæ˜ç¡®", score: 8 },
  { label: "éœ€æ±‚å®Œå…¨ä¸æ˜ç¡®", score: 10 },
];
```

### 4.4 è¡¨æ ¼åˆ—é…ç½®

```typescript
const columns: ProColumns<RiskItemConfig>[] = [
  {
    title: 'é£é™©ç±»åˆ«',
    dataIndex: 'category',
    key: 'category',
    width: '15%',
    valueType: 'select',
    valueEnum: {
      'éœ€æ±‚é£é™©': { text: 'éœ€æ±‚é£é™©' },
      'æŠ€æœ¯é£é™©': { text: 'æŠ€æœ¯é£é™©' },
      'äººå‘˜é£é™©': { text: 'äººå‘˜é£é™©' },
      'è¿›åº¦é£é™©': { text: 'è¿›åº¦é£é™©' },
      'å¤–éƒ¨é£é™©': { text: 'å¤–éƒ¨é£é™©' },
    },
    formItemProps: {
      rules: [{ required: true, message: 'è¯·é€‰æ‹©é£é™©ç±»åˆ«' }],
    },
  },
  {
    title: 'è¯„ä¼°é¡¹åç§°',
    dataIndex: 'item_name',
    key: 'item_name',
    width: '25%',
    formItemProps: {
      rules: [
        { required: true, message: 'è¯·è¾“å…¥è¯„ä¼°é¡¹åç§°' },
        { max: 100, message: 'åç§°ä¸è¶…è¿‡100å­—ç¬¦' },
      ],
    },
  },
  {
    title: 'é€‰é¡¹é…ç½®',
    dataIndex: 'options_json',
    key: 'options',
    width: '30%',
    render: (text) => {
      const options = JSON.parse(text);
      return (
        <Tooltip
          title={
            <div>
              {options.map((opt, idx) => (
                <div key={idx}>
                  {opt.label}: {opt.score}åˆ†
                </div>
              ))}
            </div>
          }
        >
          <Tag color="blue">{options.length} ä¸ªé€‰é¡¹</Tag>
        </Tooltip>
      );
    },
    renderFormItem: () => <RiskOptionsEditor />,
  },
  {
    title: 'çŠ¶æ€',
    dataIndex: 'is_active',
    key: 'is_active',
    width: '12%',
    valueType: 'select',
    valueEnum: {
      true: { text: 'å¯ç”¨', status: 'Success' },
      false: { text: 'ç¦ç”¨', status: 'Default' },
    },
  },
  {
    title: 'æ“ä½œ',
    key: 'actions',
    width: '18%',
    valueType: 'option',
    render: (_, record, __, action) => [
      <a key="edit" onClick={() => action?.startEditable(record.id)}>
        ç¼–è¾‘
      </a>,
      <a key="copy" onClick={() => copyRiskItem(record)}>
        å¤åˆ¶
      </a>,
      <Popconfirm
        key="delete"
        title="ç¡®å®šåˆ é™¤æ­¤é£é™©é¡¹å—ï¼Ÿ"
        onConfirm={() => deleteRiskItem(record.id)}
      >
        <a style={{ color: 'red' }}>åˆ é™¤</a>
      </Popconfirm>,
    ],
  },
];
```

### 4.5 é€‰é¡¹é…ç½®ç¼–è¾‘å™¨

**ç»„ä»¶**: `RiskOptionsEditor`

**åŠŸèƒ½**:
- åŠ¨æ€æ·»åŠ /åˆ é™¤é€‰é¡¹
- æ¯ä¸ªé€‰é¡¹åŒ…å«ï¼šæè¿°æ–‡æœ¬ + åˆ†å€¼
- æ‹–æ‹½æ’åº
- éªŒè¯åˆ†å€¼èŒƒå›´ï¼ˆ0-10ï¼‰

**ç•Œé¢è®¾è®¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‰é¡¹é…ç½®                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â‰¡ éœ€æ±‚éå¸¸æ˜ç¡®      [2] åˆ†  [Ã—] â”‚ â”‚
â”‚  â”‚ â‰¡ éœ€æ±‚åŸºæœ¬æ˜ç¡®      [4] åˆ†  [Ã—] â”‚ â”‚
â”‚  â”‚ â‰¡ éœ€æ±‚éƒ¨åˆ†æ˜ç¡®      [6] åˆ†  [Ã—] â”‚ â”‚
â”‚  â”‚ â‰¡ éœ€æ±‚ä¸å¤ªæ˜ç¡®      [8] åˆ†  [Ã—] â”‚ â”‚
â”‚  â”‚ â‰¡ éœ€æ±‚å®Œå…¨ä¸æ˜ç¡®   [10] åˆ†  [Ã—] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  [+ æ·»åŠ é€‰é¡¹]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.6 æ“ä½œåŠŸèƒ½

#### 4.6.1 æ–°å»ºé£é™©é¡¹

**è¡¨å•å­—æ®µ**:
- é£é™©ç±»åˆ«ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰
- è¯„ä¼°é¡¹åç§°ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰
- é€‰é¡¹é…ç½®ï¼ˆè‡ªå®šä¹‰ç¼–è¾‘å™¨ï¼‰
- çŠ¶æ€ï¼ˆé»˜è®¤å¯ç”¨ï¼‰

**é¢„è®¾æ¨¡æ¿**:
æä¾›å¸¸ç”¨é£é™©é¡¹æ¨¡æ¿ï¼Œå¿«é€Ÿåˆ›å»ºï¼š
- éœ€æ±‚æ˜ç¡®åº¦ï¼ˆ5çº§ï¼‰
- æŠ€æœ¯éš¾åº¦ï¼ˆ5çº§ï¼‰
- å›¢é˜Ÿç»éªŒï¼ˆ5çº§ï¼‰
- æ—¶é—´ç´§è¿«åº¦ï¼ˆ5çº§ï¼‰

#### 4.6.2 å¤åˆ¶é£é™©é¡¹

**ç›®çš„**: å¿«é€Ÿåˆ›å»ºç›¸ä¼¼çš„é£é™©é¡¹

**è¡Œä¸º**:
- å¤åˆ¶æ‰€æœ‰å­—æ®µï¼ˆé™¤ IDï¼‰
- åç§°è‡ªåŠ¨æ·»åŠ "(å‰¯æœ¬)"åç¼€
- è¿›å…¥ç¼–è¾‘æ¨¡å¼

---

## 5. æ¨¡å—3: å·®æ—…æˆæœ¬ç®¡ç†

### 5.1 åŠŸèƒ½æ¦‚è¿°

ç®¡ç†å·®æ—…ç›¸å…³çš„æˆæœ¬é¡¹åŠå…¶æ ‡å‡†ï¼Œç”¨äºè®¡ç®—é¡¹ç›®çš„å·®æ—…æ€»æˆæœ¬ã€‚

### 5.2 é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ å‚æ•°é…ç½® > å·®æ—…æˆæœ¬ç®¡ç†                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  ğŸ’¡ å·®æ—…æˆæœ¬æ€»è®¡: Â¥10,800 å…ƒ/æœˆ                  â”‚
â”‚                                                  â”‚
â”‚  [+ æ–°å»ºæˆæœ¬é¡¹]                [ğŸ” æœç´¢...]     â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ æˆæœ¬é¡¹    â”‚ é‡‘é¢(å…ƒ/æœˆ) â”‚ çŠ¶æ€ â”‚ æ“ä½œ    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ å¸‚å†…é€šå‹¤  â”‚ 1,500       â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â”‚ ä½å®¿      â”‚ 6,000       â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â”‚ é¤è¡¥      â”‚ 900         â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â”‚ å‡ºå·®è¡¥åŠ©  â”‚ 2,400       â”‚ å¯ç”¨ â”‚ [ç¼–è¾‘] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æ•°æ®ç»“æ„

```typescript
interface TravelCostConfig {
  id: number;
  item_name: string;        // æˆæœ¬é¡¹åç§°
  amount: number;           // é‡‘é¢ï¼ˆå…ƒ/æœˆï¼‰
  is_active: boolean;       // æ˜¯å¦å¯ç”¨
  created_at: string;
  updated_at?: string;
}
```

### 5.4 è¡¨æ ¼åˆ—é…ç½®

```typescript
const columns: ProColumns<TravelCostConfig>[] = [
  {
    title: 'æˆæœ¬é¡¹',
    dataIndex: 'item_name',
    key: 'item_name',
    width: '35%',
    formItemProps: {
      rules: [
        { required: true, message: 'è¯·è¾“å…¥æˆæœ¬é¡¹åç§°' },
        { max: 50, message: 'åç§°ä¸è¶…è¿‡50å­—ç¬¦' },
      ],
    },
  },
  {
    title: 'é‡‘é¢ï¼ˆå…ƒ/æœˆï¼‰',
    dataIndex: 'amount',
    key: 'amount',
    width: '25%',
    valueType: 'digit',
    align: 'right',
    fieldProps: {
      precision: 0,
      min: 0,
      max: 100000,
    },
    formItemProps: {
      rules: [{ required: true, message: 'è¯·è¾“å…¥é‡‘é¢' }],
    },
    render: (value) => `Â¥ ${value.toLocaleString()}`,
  },
  {
    title: 'çŠ¶æ€',
    dataIndex: 'is_active',
    key: 'is_active',
    width: '15%',
    valueType: 'select',
    valueEnum: {
      true: { text: 'å¯ç”¨', status: 'Success' },
      false: { text: 'ç¦ç”¨', status: 'Default' },
    },
  },
  {
    title: 'æ“ä½œ',
    key: 'actions',
    width: '25%',
    valueType: 'option',
    render: (_, record, __, action) => [
      <a key="edit" onClick={() => action?.startEditable(record.id)}>
        ç¼–è¾‘
      </a>,
      <Popconfirm
        key="delete"
        title="ç¡®å®šåˆ é™¤æ­¤æˆæœ¬é¡¹å—ï¼Ÿ"
        onConfirm={() => deleteTravelCost(record.id)}
      >
        <a style={{ color: 'red' }}>åˆ é™¤</a>
      </Popconfirm>,
    ],
  },
];
```

### 5.5 æ€»è®¡æ˜¾ç¤º

**è®¡ç®—é€»è¾‘**:
```typescript
const totalMonthly = useMemo(() => {
  return travelCosts
    .filter(item => item.is_active)
    .reduce((sum, item) => sum + item.amount, 0);
}, [travelCosts]);
```

**æ˜¾ç¤ºä½ç½®**: é¡µé¢é¡¶éƒ¨ï¼Œé†’ç›®å±•ç¤º

---

## 6. API æ¥å£

### 6.1 è§’è‰²ç®¡ç†æ¥å£

```
GET    /api/config/roles           # è·å–è§’è‰²åˆ—è¡¨
GET    /api/config/roles/:id       # è·å–è§’è‰²è¯¦æƒ…
POST   /api/config/roles           # åˆ›å»ºè§’è‰²
PUT    /api/config/roles/:id       # æ›´æ–°è§’è‰²
DELETE /api/config/roles/:id       # åˆ é™¤è§’è‰²
```

### 6.2 é£é™©é¡¹ç®¡ç†æ¥å£

```
GET    /api/config/risk-items      # è·å–é£é™©é¡¹åˆ—è¡¨
GET    /api/config/risk-items/:id  # è·å–é£é™©é¡¹è¯¦æƒ…
POST   /api/config/risk-items      # åˆ›å»ºé£é™©é¡¹
PUT    /api/config/risk-items/:id  # æ›´æ–°é£é™©é¡¹
DELETE /api/config/risk-items/:id  # åˆ é™¤é£é™©é¡¹
```

### 6.3 å·®æ—…æˆæœ¬ç®¡ç†æ¥å£

```
GET    /api/config/travel-costs    # è·å–å·®æ—…æˆæœ¬åˆ—è¡¨
GET    /api/config/travel-costs/:id # è·å–æˆæœ¬é¡¹è¯¦æƒ…
POST   /api/config/travel-costs    # åˆ›å»ºæˆæœ¬é¡¹
PUT    /api/config/travel-costs/:id # æ›´æ–°æˆæœ¬é¡¹
DELETE /api/config/travel-costs/:id # åˆ é™¤æˆæœ¬é¡¹
```

### 6.4 æ‰¹é‡è·å–æ¥å£

```
GET    /api/config/all             # ä¸€æ¬¡æ€§è·å–æ‰€æœ‰é…ç½®
å“åº”: {
  data: {
    roles: RoleConfig[],
    risk_items: RiskItemConfig[],
    travel_costs: TravelCostConfig[]
  }
}
```

---

## 7. æ•°æ®åˆå§‹åŒ–

### 7.1 ç§å­æ•°æ®

**ä½ç½®**: `server/seed-data/`

**è„šæœ¬**:
- `seed-roles.js` - åˆå§‹åŒ–9ä¸ªè§’è‰²
- `seed-risk-items.js` - åˆå§‹åŒ–é£é™©è¯„ä¼°é¡¹
- `seed-travel-costs.js` - åˆå§‹åŒ–4ä¸ªå·®æ—…æˆæœ¬é¡¹
- `seed-all.js` - ä¸€é”®åˆå§‹åŒ–æ‰€æœ‰æ•°æ®

**æ‰§è¡Œ**:
```bash
cd server/seed-data
node seed-all.js
```

---

## 8. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### 8.1 ç¼–è¾‘ä½“éªŒ

- ä½¿ç”¨ ProTable çš„å¯ç¼–è¾‘è¡¨æ ¼
- è¡Œå†…ç¼–è¾‘ï¼Œå³æ—¶ä¿å­˜
- ç¼–è¾‘æ—¶è‡ªåŠ¨èšç„¦ç¬¬ä¸€ä¸ªå­—æ®µ
- ESC é”®å–æ¶ˆç¼–è¾‘

### 8.2 è§†è§‰åé¦ˆ

- ä¿å­˜æˆåŠŸæ˜¾ç¤º Toast æç¤º
- åˆ é™¤æ“ä½œæ˜¾ç¤ºäºŒæ¬¡ç¡®è®¤
- ç¦ç”¨çŠ¶æ€ä½¿ç”¨ç°è‰² Badge
- é‡‘é¢å­—æ®µåƒåˆ†ä½æ ¼å¼åŒ–

### 8.3 ç©ºçŠ¶æ€

**æ— æ•°æ®æ—¶æ˜¾ç¤º**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          âš™ï¸                 â”‚
â”‚                             â”‚
â”‚      æš‚æ— é…ç½®æ•°æ®           â”‚
â”‚                             â”‚
â”‚  [+ åˆ›å»ºç¬¬ä¸€æ¡é…ç½®]         â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. å¼‚å¸¸å¤„ç†

### 9.1 æ•°æ®æ ¡éªŒ

- å‰ç«¯æ ¡éªŒ + åç«¯æ ¡éªŒåŒé‡ä¿éšœ
- å¿…å¡«é¡¹ä¸èƒ½ä¸ºç©º
- æ•°å€¼èŒƒå›´é™åˆ¶
- å”¯ä¸€æ€§çº¦æŸæ£€æŸ¥

### 9.2 åˆ é™¤é™åˆ¶

- æ­£åœ¨ä½¿ç”¨çš„é…ç½®ä¸èƒ½åˆ é™¤
- æç¤ºå½±å“èŒƒå›´
- å»ºè®®ä½¿ç”¨ç¦ç”¨åŠŸèƒ½

### 9.3 ç½‘ç»œé”™è¯¯

- æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
- æä¾›é‡è¯•æŒ‰é’®
- ä¿ç•™ç”¨æˆ·ç¼–è¾‘å†…å®¹

---

## 10. æ€§èƒ½ä¼˜åŒ–

### 10.1 æ•°æ®åŠ è½½

- ä½¿ç”¨ useSWR ç¼“å­˜é…ç½®æ•°æ®
- é…ç½®æ•°æ®ä¸é¢‘ç¹å˜åŒ–ï¼Œç¼“å­˜æ—¶é—´è¾ƒé•¿
- æ‰¹é‡è·å–æ¥å£å‡å°‘è¯·æ±‚æ¬¡æ•°

### 10.2 åˆ—è¡¨æ¸²æŸ“

- ProTable å†…ç½®è™šæ‹Ÿæ»šåŠ¨
- åˆ†é¡µåŠ è½½ï¼ˆå¦‚æ•°æ®é‡å¤§ï¼‰
- æœç´¢é˜²æŠ–

---

## 11. æµ‹è¯•è¦ç‚¹

### 11.1 åŠŸèƒ½æµ‹è¯•

- âœ… CRUD æ“ä½œæ­£å¸¸
- âœ… æ•°æ®æ ¡éªŒç”Ÿæ•ˆ
- âœ… å¯ç”¨/ç¦ç”¨çŠ¶æ€åˆ‡æ¢
- âœ… åˆ é™¤é™åˆ¶æ­£ç¡®
- âœ… æœç´¢åŠŸèƒ½å‡†ç¡®

### 11.2 æ•°æ®å®Œæ•´æ€§

- âœ… å¹¶å‘ç¼–è¾‘å†²çªå¤„ç†
- âœ… æ•°æ®å…³è”çº¦æŸæ£€æŸ¥
- âœ… JSON æ ¼å¼æ­£ç¡®è§£æ

### 11.3 è¾¹ç•Œæµ‹è¯•

- âœ… æœ€å¤§/æœ€å°å€¼é™åˆ¶
- âœ… ç‰¹æ®Šå­—ç¬¦å¤„ç†
- âœ… é•¿æ–‡æœ¬æˆªæ–­

---

**æ–‡æ¡£ç»“æŸ**
