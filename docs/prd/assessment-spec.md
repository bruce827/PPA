# é¡¹ç›®è¯„ä¼°åŠŸèƒ½è¯¦ç»†è§„æ ¼

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-21

---

## 1. åŠŸèƒ½æ¦‚è¿°

é¡¹ç›®è¯„ä¼°æ¨¡å—æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæä¾›å®Œæ•´çš„é¡¹ç›®æˆæœ¬å’Œé£é™©è¯„ä¼°æµç¨‹ã€‚é€šè¿‡åˆ†æ­¥å‘å¯¼çš„æ–¹å¼ï¼Œå¼•å¯¼ç”¨æˆ·å®Œæˆä»é£é™©è¯„ä¼°ã€å·¥ä½œé‡ä¼°ç®—åˆ°æˆæœ¬æ±‡æ€»çš„å…¨è¿‡ç¨‹ã€‚

## 2. åŠŸèƒ½å…¥å£

### 2.1 è·¯ç”±

- **æ–°å»ºè¯„ä¼°**: `/assessment/new`
- **ç¼–è¾‘è¯„ä¼°**: `/assessment/new?edit_id={project_id}`

### 2.2 å¯¼èˆªå…¥å£

- å·¦ä¾§èœå•ï¼šé¡¹ç›®è¯„ä¼° â†’ æ–°å»ºè¯„ä¼°
- å†å²é¡¹ç›®åˆ—è¡¨ï¼šç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®

## 3. åˆ†æ­¥è¯„ä¼°æµç¨‹

### 3.1 æµç¨‹æ€»è§ˆ

```
æ­¥éª¤0: æ¨¡æ¿é€‰æ‹©ï¼ˆå¯é€‰ï¼‰
    â†“
æ­¥éª¤1: é£é™©è¯„åˆ†
    â†“
æ­¥éª¤2: å·¥ä½œé‡ä¼°ç®—
    â†“
æ­¥éª¤3: å…¶ä»–æˆæœ¬
    â†“
æ­¥éª¤4: ç”Ÿæˆæ€»è§ˆä¸ä¿å­˜
```

## 4. æ­¥éª¤è¯¦ç»†è®¾è®¡

### æ­¥éª¤0: æ¨¡æ¿é€‰æ‹©ï¼ˆå¯é€‰ï¼‰

#### 4.1.1 ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»æ¨¡æ¿åˆ›å»ºï¼ˆå¯é€‰ï¼‰                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”½ è¯·é€‰æ‹©æ¨¡æ¿                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.2 åŠŸèƒ½è¯´æ˜

- **ä½ç½®**: é¡µé¢é¡¶éƒ¨ï¼Œåœ¨æ­¥éª¤æ¡ä¹‹å‰
- **ç»„ä»¶**: ä¸‹æ‹‰é€‰æ‹©æ¡†ï¼ˆSelectï¼‰
- **æ•°æ®æº**: ä» `/api/projects?is_template=1` è·å–æ¨¡æ¿åˆ—è¡¨
- **äº¤äº’**:
  - é€‰æ‹©æ¨¡æ¿åï¼Œè‡ªåŠ¨å¡«å……æ‰€æœ‰æ­¥éª¤çš„è¡¨å•æ•°æ®
  - æ”¯æŒæ¸…ç©ºé€‰æ‹©ï¼Œæ¢å¤ç©ºè¡¨å•
  - æ¨¡æ¿æ•°æ®åŒ…æ‹¬ï¼šé£é™©è¯„åˆ†ã€å·¥ä½œé‡è®°å½•ã€å…¶ä»–æˆæœ¬é…ç½®

#### 4.1.3 æ•°æ®åŠ è½½é€»è¾‘

```typescript
// 1. è·å–æ¨¡æ¿åˆ—è¡¨
const templates = await fetch('/api/projects?is_template=1');

// 2. ç”¨æˆ·é€‰æ‹©æ¨¡æ¿
onTemplateSelect(templateId) {
  // åŠ è½½æ¨¡æ¿è¯¦æƒ…
  const template = await fetch(`/api/projects/${templateId}`);
  
  // è§£æå¹¶å¡«å……è¡¨å•
  const data = JSON.parse(template.assessment_details_json);
  form.setFieldsValue(data);
}
```

---

### æ­¥éª¤1: é£é™©è¯„åˆ†

#### 4.2.1 ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 1: é£é™©è¯„åˆ†                           â”‚
â”‚                                             â”‚
â”‚  é£é™©ç±»åˆ«1                                  â”‚
â”‚  â”œâ”€ è¯„ä¼°é¡¹1.1  [ä¸‹æ‹‰é€‰æ‹© â–¼]                â”‚
â”‚  â”œâ”€ è¯„ä¼°é¡¹1.2  [ä¸‹æ‹‰é€‰æ‹© â–¼]                â”‚
â”‚  â””â”€ è¯„ä¼°é¡¹1.3  [ä¸‹æ‹‰é€‰æ‹© â–¼]                â”‚
â”‚                                             â”‚
â”‚  é£é™©ç±»åˆ«2                                  â”‚
â”‚  â”œâ”€ è¯„ä¼°é¡¹2.1  [ä¸‹æ‹‰é€‰æ‹© â–¼]                â”‚
â”‚  â””â”€ è¯„ä¼°é¡¹2.2  [ä¸‹æ‹‰é€‰æ‹© â–¼]                â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é£é™©è¯„åˆ†æ€»è§ˆ                        â”‚   â”‚
â”‚  â”‚ â€¢ å·²è¯„ä¼°: 5/5                      â”‚   â”‚
â”‚  â”‚ â€¢ é£é™©æ€»åˆ†: 85 / 200              â”‚   â”‚
â”‚  â”‚ â€¢ è¯„åˆ†å› å­: 0.43                  â”‚   â”‚
â”‚  â”‚ â€¢ é£é™©ç­‰çº§: ğŸŸ¡ ä¸­é£é™©              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  [ä¸Šä¸€æ­¥]              [ä¸‹ä¸€æ­¥] â†’          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.2 æ•°æ®ç»“æ„

```typescript
// é£é™©è¯„ä¼°é¡¹é…ç½®ï¼ˆä»åç«¯è·å–ï¼‰
interface RiskItemConfig {
  id: number;
  category: string;          // é£é™©ç±»åˆ«
  item_name: string;         // è¯„ä¼°é¡¹åç§°
  options_json: string;      // é€‰é¡¹é…ç½®ï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
  is_active: boolean;
}

// é€‰é¡¹é…ç½®è§£æåçš„æ ¼å¼
interface RiskOption {
  label: string;   // é€‰é¡¹æè¿°ï¼Œå¦‚"ä½é£é™©"
  score: number;   // å¯¹åº”åˆ†å€¼ï¼Œå¦‚ 2
}

// ç”¨æˆ·é€‰æ‹©çš„é£é™©è¯„åˆ†
interface RiskScores {
  [risk_item_id: number]: number;  // { 1: 5, 2: 3, ... }
}
```

#### 4.2.3 è®¡ç®—é€»è¾‘

```typescript
// 1. é£é™©æ€»åˆ†
const totalScore = Object.values(riskScores).reduce((sum, score) => sum + score, 0);

// 2. æœ€å¤§å¯èƒ½åˆ†å€¼
const maxScore = riskItems.reduce((sum, item) => {
  const options = JSON.parse(item.options_json);
  const maxOption = Math.max(...options.map(opt => opt.score));
  return sum + maxOption;
}, 0);

// 3. è¯„åˆ†å› å­
const factor = totalScore / 100;

// 4. é£é™©ç­‰çº§åˆ¤å®š
const ratio = totalScore / maxScore;
let level = 'ä½é£é™©';
if (ratio >= 0.7) level = 'é«˜é£é™©';
else if (ratio >= 0.4) level = 'ä¸­é£é™©';
```

#### 4.2.4 éªŒè¯è§„åˆ™

- âœ… æ‰€æœ‰é£é™©é¡¹å¿…é¡»å®Œæˆè¯„åˆ†ï¼ˆä¸èƒ½æœ‰æœªé€‰æ‹©çš„é¡¹ï¼‰
- âœ… è¯„åˆ†æ€»åˆ† â‰¥ 0
- âš ï¸ å¦‚æœæœªå®Œæˆè¯„åˆ†ï¼Œç‚¹å‡»"ä¸‹ä¸€æ­¥"æ—¶æ˜¾ç¤ºæç¤º

---

### æ­¥éª¤2: å·¥ä½œé‡ä¼°ç®—

#### 4.3.1 ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 2: å·¥ä½œé‡ä¼°ç®—                               â”‚
â”‚                                                   â”‚
â”‚  [æ–°åŠŸèƒ½å¼€å‘] [ç³»ç»Ÿå¯¹æ¥å·¥ä½œé‡]                    â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”                                      â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä¸€çº§  â”‚ äºŒçº§  â”‚ ä¸‰çº§  â”‚ è¯´æ˜  â”‚ äº¤ä»˜ â”‚ ... â”‚  â”‚
â”‚  â”‚ æ¨¡å—  â”‚ æ¨¡å—  â”‚ æ¨¡å—  â”‚       â”‚ ç³»æ•° â”‚     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [è¾“å…¥]â”‚[è¾“å…¥]â”‚[è¾“å…¥]â”‚[è¾“å…¥]â”‚ 1.0  â”‚è§’è‰²1â”‚  â”‚
â”‚  â”‚                                    â”‚ 3å¤© â”‚  â”‚
â”‚  â”‚                              è§’è‰²2 â”‚ 5å¤© â”‚  â”‚
â”‚  â”‚                              ...          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                   â”‚
â”‚  [+ æ·»åŠ åŠŸèƒ½æ¨¡å—]                                 â”‚
â”‚                                                   â”‚
â”‚  [ä¸Šä¸€æ­¥] â†            [ä¸‹ä¸€æ­¥] â†’                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3.2 æ•°æ®ç»“æ„

```typescript
interface WorkloadRecord {
  // æ¨¡å—ä¿¡æ¯
  level1_module: string;      // ä¸€çº§æ¨¡å—åç§°
  level2_module: string;      // äºŒçº§æ¨¡å—åç§°
  level3_module?: string;     // ä¸‰çº§æ¨¡å—åç§°ï¼ˆå¯é€‰ï¼‰
  description: string;        // åŠŸèƒ½è¯´æ˜
  
  // å·¥ä½œé‡é…ç½®
  delivery_coefficient: number;  // äº¤ä»˜ç³»æ•°ï¼Œé»˜è®¤ 1.0
  role_workdays: {              // å„è§’è‰²å·¥ä½œå¤©æ•°
    [role_id: number]: number;  // { 1: 3, 2: 5, 3: 2 }
  };
  
  // è®¡ç®—ç»“æœï¼ˆå‰ç«¯è®¡ç®—ï¼‰
  total_workdays?: number;      // æ€»å·¥ä½œå¤©æ•°
  total_cost?: number;          // æ¨¡å—æ€»æˆæœ¬ï¼ˆä¸‡å…ƒï¼‰
}
```

#### 4.3.3 è®¡ç®—é€»è¾‘

```typescript
// å•ä¸ªæ¨¡å—çš„å·¥ä½œé‡å’Œæˆæœ¬è®¡ç®—
function calculateModuleCost(record: WorkloadRecord, roles: RoleConfig[]): number {
  let totalCost = 0;
  
  // éå†æ¯ä¸ªè§’è‰²çš„å·¥ä½œå¤©æ•°
  for (const [roleId, days] of Object.entries(record.role_workdays)) {
    const role = roles.find(r => r.id === parseInt(roleId));
    if (role && days > 0) {
      // æˆæœ¬ = å¤©æ•° Ã— å•ä»· / 20ï¼ˆæœˆå·¥ä½œæ—¥ï¼‰
      const cost = (days * role.unit_price / 20) * record.delivery_coefficient;
      totalCost += cost;
    }
  }
  
  return totalCost;
}

// æ‰€æœ‰æ¨¡å—çš„æ±‡æ€»
const developmentCost = developmentWorkload.reduce((sum, record) => {
  return sum + calculateModuleCost(record, roles);
}, 0);

const integrationCost = integrationWorkload.reduce((sum, record) => {
  return sum + calculateModuleCost(record, roles);
}, 0);
```

#### 4.3.4 äº¤äº’è¯´æ˜

**Tab åˆ‡æ¢**:
- æ–°åŠŸèƒ½å¼€å‘ï¼ˆé»˜è®¤ï¼‰
- ç³»ç»Ÿå¯¹æ¥å·¥ä½œé‡

**æ·»åŠ æ¨¡å—**:
- ç‚¹å‡»"+ æ·»åŠ åŠŸèƒ½æ¨¡å—"æŒ‰é’®
- ä½¿ç”¨ ProTable çš„å¯ç¼–è¾‘è¡¨æ ¼åŠŸèƒ½
- æ”¯æŒè¡Œå†…ç¼–è¾‘

**è§’è‰²å·¥ä½œå¤©æ•°**:
- æ¯ä¸ªæ¨¡å—å¯ä¸ºå¤šä¸ªè§’è‰²åˆ†é…å·¥ä½œå¤©æ•°
- åŠ¨æ€åˆ—æ˜¾ç¤ºï¼ˆæ ¹æ®ç³»ç»Ÿé…ç½®çš„è§’è‰²ç”Ÿæˆï¼‰
- è¾“å…¥æ¡†è‡ªåŠ¨è®¡ç®—æ€»å·¥æ—¶

**åˆ é™¤æ¨¡å—**:
- æ¯è¡Œå³ä¾§æœ‰åˆ é™¤æŒ‰é’®
- ç¡®è®¤ååˆ é™¤

#### 4.3.5 éªŒè¯è§„åˆ™

- âš ï¸ è‡³å°‘æ·»åŠ ä¸€ä¸ªæ¨¡å—ï¼ˆæ–°åŠŸèƒ½å¼€å‘æˆ–ç³»ç»Ÿå¯¹æ¥ï¼‰
- âœ… ä¸€çº§æ¨¡å—åç§°å¿…å¡«
- âœ… å·¥ä½œå¤©æ•° â‰¥ 0
- âœ… äº¤ä»˜ç³»æ•° > 0ï¼Œé»˜è®¤ 1.0

---

### æ­¥éª¤3: å…¶ä»–æˆæœ¬

#### 4.4.1 ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 3: å…¶ä»–æˆæœ¬                         â”‚
â”‚                                           â”‚
â”‚  ğŸ’¼ å·®æ—…æˆæœ¬                              â”‚
â”‚  â”œâ”€ å·®æ—…æœˆæ•°: [____] æœˆ                  â”‚
â”‚  â””â”€ é¢„è®¡æˆæœ¬: Â¥ 32,400                   â”‚
â”‚      (æ¯æœˆ Â¥10,800 Ã— 3 æœˆ)               â”‚
â”‚                                           â”‚
â”‚  ğŸ”§ è¿ç»´æˆæœ¬                              â”‚
â”‚  â”œâ”€ è¿ç»´æœˆæ•°: [____] æœˆ                  â”‚
â”‚  â”œâ”€ å¹³å‡äººæ•°: [____] äºº                  â”‚
â”‚  â””â”€ é¢„è®¡æˆæœ¬: Â¥ 90,000                   â”‚
â”‚      (6æœˆ Ã— 2äºº Ã— Â¥7,500/äººæœˆ)          â”‚
â”‚                                           â”‚
â”‚  âš ï¸ é£é™©æˆæœ¬                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ é£é™©æè¿°           â”‚ é¢„ä¼°è´¹ç”¨ï¼ˆä¸‡å…ƒï¼‰â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ [è¾“å…¥æ¡†]           â”‚ [è¾“å…¥æ¡†]        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  [+ æ·»åŠ é£é™©é¡¹]                          â”‚
â”‚                                           â”‚
â”‚  [ä¸Šä¸€æ­¥] â†            [ä¸‹ä¸€æ­¥] â†’        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.4.2 æ•°æ®ç»“æ„

```typescript
interface OtherCosts {
  // å·®æ—…æˆæœ¬
  travel_months: number;           // å·®æ—…æœˆæ•°
  travel_cost?: number;            // è‡ªåŠ¨è®¡ç®—
  
  // è¿ç»´æˆæœ¬
  maintenance_months: number;      // è¿ç»´æœˆæ•°
  maintenance_headcount: number;   // è¿ç»´äººæ•°
  maintenance_cost?: number;       // è‡ªåŠ¨è®¡ç®—
  
  // é£é™©æˆæœ¬
  risk_items: Array<{
    description: string;           // é£é™©æè¿°
    estimated_cost: number;        // é¢„ä¼°è´¹ç”¨ï¼ˆä¸‡å…ƒï¼‰
  }>;
  risk_cost?: number;             // è‡ªåŠ¨è®¡ç®—
}
```

#### 4.4.3 è®¡ç®—é€»è¾‘

```typescript
// 1. å·®æ—…æˆæœ¬
const travelCostStandard = 10800; // å…ƒ/äºº/æœˆï¼ˆä»é…ç½®è¡¨è·å–ï¼‰
const travelCost = (travel_months * travelCostStandard) / 10000; // è½¬ä¸ºä¸‡å…ƒ

// 2. è¿ç»´æˆæœ¬
const avgRolePrice = roles.reduce((sum, r) => sum + r.unit_price, 0) / roles.length;
const maintenanceCost = maintenance_months * maintenance_headcount * avgRolePrice;

// 3. é£é™©æˆæœ¬
const riskCost = risk_items.reduce((sum, item) => sum + item.estimated_cost, 0);
```

#### 4.4.4 éªŒè¯è§„åˆ™

- âœ… å·®æ—…æœˆæ•° â‰¥ 0
- âœ… è¿ç»´æœˆæ•° â‰¥ 0
- âœ… è¿ç»´äººæ•° â‰¥ 0
- âœ… é£é™©æˆæœ¬ â‰¥ 0
- âš ï¸ å¦‚æœè¾“å…¥äº†å·®æ—…æœˆæ•°ä½†ä¸º0ï¼Œç»™äºˆæç¤º

---

### æ­¥éª¤4: ç”Ÿæˆæ€»è§ˆä¸ä¿å­˜

#### 4.5.1 ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­¥éª¤ 4: è¯„ä¼°æ€»è§ˆ                         â”‚
â”‚                                           â”‚
â”‚  ğŸ“Š æˆæœ¬æ±‡æ€»                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è½¯ä»¶ç ”å‘æˆæœ¬      â”‚ Â¥ 125.50ä¸‡      â”‚  â”‚
â”‚  â”‚ ç³»ç»Ÿå¯¹æ¥æˆæœ¬      â”‚ Â¥  35.20ä¸‡      â”‚  â”‚
â”‚  â”‚ å·®æ—…æˆæœ¬          â”‚ Â¥   3.24ä¸‡      â”‚  â”‚
â”‚  â”‚ è¿ç»´æˆæœ¬          â”‚ Â¥   9.00ä¸‡      â”‚  â”‚
â”‚  â”‚ é£é™©æˆæœ¬          â”‚ Â¥   5.00ä¸‡      â”‚  â”‚
â”‚  â”‚â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‚  â”‚
â”‚  â”‚ æŠ¥ä»·æ€»è®¡          â”‚ Â¥ 177.94ä¸‡      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                           â”‚
â”‚  ğŸ“ é¡¹ç›®ä¿¡æ¯                              â”‚
â”‚  â”œâ”€ é¡¹ç›®åç§°: [å¿…å¡«] ________________    â”‚
â”‚  â”œâ”€ é¡¹ç›®æè¿°: [é€‰å¡«]                     â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   â”‚                               â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â””â”€ â–¡ å¦å­˜ä¸ºæ¨¡æ¿                         â”‚
â”‚                                           â”‚
â”‚  [ä¸Šä¸€æ­¥] â†     [ä¿å­˜é¡¹ç›®] ğŸ’¾            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.5.2 æ•°æ®æ±‡æ€»

```typescript
interface CalculationResult {
  development_cost: number;      // è½¯ä»¶ç ”å‘æˆæœ¬
  integration_cost: number;      // ç³»ç»Ÿå¯¹æ¥æˆæœ¬
  travel_cost: number;          // å·®æ—…æˆæœ¬
  maintenance_cost: number;     // è¿ç»´æˆæœ¬
  risk_cost: number;           // é£é™©æˆæœ¬
  total_cost: number;          // æ€»è®¡
  
  // é¢å¤–ç»Ÿè®¡
  total_workdays: number;      // æ€»å·¥ä½œå¤©æ•°
  risk_total_score: number;    // é£é™©æ€»åˆ†
  risk_level: string;          // é£é™©ç­‰çº§
}
```

#### 4.5.3 ä¿å­˜æµç¨‹

```typescript
async function saveProject(values: {
  projectName: string;
  projectDescription?: string;
  is_template: boolean;
}) {
  // 1. å‡†å¤‡ä¿å­˜æ•°æ®
  const payload = {
    name: values.projectName,
    description: values.projectDescription || '',
    is_template: values.is_template,
    final_total_cost: calculationResult.total_cost,
    final_risk_score: riskScoreSummary.total,
    final_workload_days: calculationResult.total_workdays,
    assessment_details_json: JSON.stringify({
      risk_scores: assessmentData.risk_scores,
      development_workload: assessmentData.development_workload,
      integration_workload: assessmentData.integration_workload,
      travel_months: assessmentData.travel_months,
      maintenance_months: assessmentData.maintenance_months,
      maintenance_headcount: assessmentData.maintenance_headcount,
      risk_items: assessmentData.risk_items,
      roles: configData.roles, // ä¿å­˜è§’è‰²é…ç½®å¿«ç…§
    }),
  };
  
  // 2. è°ƒç”¨API
  if (editId) {
    // æ›´æ–°å·²æœ‰é¡¹ç›®
    await fetch(`/api/projects/${editId}`, {
      method: 'PUT',
      body: JSON.stringify(payload),
    });
  } else {
    // åˆ›å»ºæ–°é¡¹ç›®
    await fetch('/api/projects', {
      method: 'POST',
      body: JSON.stringify(payload),
    });
  }
  
  // 3. è·³è½¬åˆ°å†å²é¡¹ç›®é¡µé¢
  history.push('/assessment/history');
}
```

#### 4.5.4 éªŒè¯è§„åˆ™

- âœ… é¡¹ç›®åç§°å¿…å¡«
- âœ… é¡¹ç›®åç§°é•¿åº¦ â‰¤ 100 å­—ç¬¦
- âš ï¸ å¦‚æœæ˜¯æ¨¡æ¿ï¼Œæç¤ºæ¨¡æ¿å¯è¢«å…¶ä»–é¡¹ç›®å¤ç”¨

---

## 5. API æ¥å£

### 5.1 è·å–é…ç½®æ•°æ®

```
GET /api/config/all
```

**å“åº”**:
```json
{
  "data": {
    "roles": [...],
    "risk_items": [...],
    "travel_costs": [...]
  }
}
```

### 5.2 è®¡ç®—æˆæœ¬ï¼ˆå¯é€‰ï¼Œç›®å‰å‰ç«¯è®¡ç®—ï¼‰

```
POST /api/calculate
```

**è¯·æ±‚ä½“**:
```json
{
  "assessmentData": { ... },
  "roles": [ ... ]
}
```

**å“åº”**:
```json
{
  "data": {
    "development_cost": 125.5,
    "integration_cost": 35.2,
    ...
  }
}
```

### 5.3 ä¿å­˜é¡¹ç›®

```
POST /api/projects
PUT /api/projects/:id
```

**è¯·æ±‚ä½“**: è§æ­¥éª¤4ä¿å­˜æµç¨‹

---

## 6. å¼‚å¸¸å¤„ç†

### 6.1 ç½‘ç»œé”™è¯¯

- æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
- æä¾›é‡è¯•æŒ‰é’®
- ä¿ç•™ç”¨æˆ·å·²è¾“å…¥çš„æ•°æ®

### 6.2 æ•°æ®éªŒè¯å¤±è´¥

- é«˜äº®æ˜¾ç¤ºé”™è¯¯å­—æ®µ
- æ˜¾ç¤ºå…·ä½“é”™è¯¯åŸå› 
- é˜»æ­¢è¿›å…¥ä¸‹ä¸€æ­¥

### 6.3 ä¿å­˜å¤±è´¥

- æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
- ä¸è·³è½¬é¡µé¢
- å…è®¸ç”¨æˆ·ä¿®æ”¹åé‡è¯•

---

## 7. æ€§èƒ½ä¼˜åŒ–

### 7.1 æ•°æ®åŠ è½½

- é…ç½®æ•°æ®åªåŠ è½½ä¸€æ¬¡
- ä½¿ç”¨ React.useMemo ç¼“å­˜è®¡ç®—ç»“æœ
- é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

### 7.2 è¡¨å•æ€§èƒ½

- å¤§å‹è¡¨æ ¼ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
- é˜²æŠ–è¾“å…¥äº‹ä»¶
- æŒ‰éœ€æ¸²æŸ“åˆ—

---

## 8. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### 8.1 æ­¥éª¤å¯¼èˆª

- æ­¥éª¤æ¡æ˜¾ç¤ºå½“å‰è¿›åº¦
- æ”¯æŒç‚¹å‡»æ­¥éª¤æ¡å¿«é€Ÿè·³è½¬ï¼ˆå·²å®Œæˆçš„æ­¥éª¤ï¼‰
- æœ€åä¸€æ­¥æ˜¾ç¤º"å®Œæˆ"æ ‡è¯†

### 8.2 æ•°æ®ä¿ç•™

- åœ¨æ­¥éª¤é—´åˆ‡æ¢æ—¶ä¿ç•™å·²å¡«å†™çš„æ•°æ®
- ç¼–è¾‘æ¨¡å¼è‡ªåŠ¨åŠ è½½é¡¹ç›®æ•°æ®
- æ¨¡æ¿é€‰æ‹©åå¯æ¸…ç©ºé‡å¡«

### 8.3 è§†è§‰åé¦ˆ

- å®æ—¶æ˜¾ç¤ºé£é™©è¯„åˆ†ç»Ÿè®¡
- å®æ—¶æ˜¾ç¤ºæˆæœ¬æ±‡æ€»
- åŠ è½½çŠ¶æ€ä½¿ç”¨ Skeleton å ä½ç¬¦

---

**æ–‡æ¡£ç»“æŸ**
